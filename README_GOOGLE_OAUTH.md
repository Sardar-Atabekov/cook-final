# Google OAuth Integration

Этот проект включает интеграцию Google OAuth для авторизации пользователей.

## Что было добавлено

### 1. Компоненты

- `GoogleAuthButton` - кнопка для входа через Google (popup окно)
- `GoogleAuthButtonRedirect` - альтернативная кнопка (redirect)
- `GoogleCallbackPage` - страница обработки callback

### 2. API и хуки

- Добавлены методы в `authApi` для работы с Google OAuth
- Создан хук `useGoogleAuthMutation` для мутации Google авторизации

### 3. Переводы

- Добавлены переводы для Google OAuth на английский и русский языки

## Как использовать

### На страницах входа и регистрации

Google кнопка автоматически добавлена на страницы:

- `/auth/login` - страница входа
- `/auth/signup` - страница регистрации

### Ручное добавление кнопки

```tsx
import { GoogleAuthButton } from '@/components/google-auth-button';

function MyComponent() {
  return (
    <div>
      <GoogleAuthButton />
    </div>
  );
}
```

## Настройка бэкенда

Следуйте инструкциям в файле `GOOGLE_OAUTH_SETUP.md` для настройки бэкенда.

## Переменные окружения

Добавьте в ваш `.env.local`:

```env
NEXT_PUBLIC_SERVER=http://localhost:5000
```

## Как это работает

### Popup вариант (по умолчанию)

1. Пользователь нажимает кнопку "Войти через Google"
2. Открывается popup окно с Google OAuth
3. После авторизации Google перенаправляет на callback страницу
4. Callback страница обрабатывает код и отправляет сообщение в родительское окно
5. Родительское окно получает токен и данные пользователя
6. Пользователь авторизуется в приложении

### Redirect вариант

1. Пользователь нажимает кнопку "Войти через Google"
2. Происходит перенаправление на Google OAuth
3. После авторизации Google перенаправляет обратно на callback страницу
4. Callback страница обрабатывает код и перенаправляет пользователя на главную страницу

## Обработка ошибок

- Блокировка popup окон
- Ошибки авторизации
- Сетевые ошибки
- Неверные данные

## Безопасность

- Валидация origin для postMessage
- Проверка JWT токенов
- Безопасное хранение секретов
- HTTPS в продакшене

## Тестирование

1. Убедитесь, что бэкенд настроен согласно `GOOGLE_OAUTH_SETUP.md`
2. Запустите фронтенд: `pnpm dev`
3. Перейдите на страницу входа или регистрации
4. Нажмите кнопку "Войти через Google"
5. Убедитесь, что авторизация работает корректно

## Устранение неполадок

### Popup не открывается

- Проверьте настройки блокировщика рекламы
- Убедитесь, что домен добавлен в разрешенные

### Ошибка авторизации

- Проверьте настройки Google OAuth в Google Cloud Console
- Убедитесь, что callback URL настроен правильно
- Проверьте переменные окружения

### Ошибка CORS

- Убедитесь, что бэкенд разрешает запросы с фронтенда
- Проверьте настройки CORS на бэкенде
